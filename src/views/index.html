<html>
<head>
    <title>Hello World!</title>
    <script src="../scripts/pcapng-js/pcapng-js.js"></script>
    <script src="../scripts/pcapng-js/block-types.js"></script>
    <script src="../scripts/pcapng-js/headers.js"></script>
</head>
<body>
<h1>Hello World!</h1>

<input type="file"/>

<h1 onclick="readPcap()">Read me</h1>
</body>
<script>
    function test() {
        var fileInput = document.querySelector('input[type=file]');
        var path = fileInput.value;

        var fs = nw.require('fs');
        fs.readFile(path, 'utf8', function (err, txt) {
            if (err) {
                console.error(err);
                return;
            }

            console.log(txt);
        });


    }

    function readPcap() {
        var fileInput = document.querySelector('input[type=file]');
        var path = fileInput.value;


        var arrayBuffer;
        var fileReader = new FileReader();
        fileReader.onload = function () {
            arrayBuffer = this.result;

            var blocks = PCAPNG.processPcapng(arrayBuffer);
            console.log(blocks.length);
        }
        fileReader.readAsArrayBuffer(fileInput.files[0]);

        //var file = new File(path);
        //var blocks = PCAPNG.processPcapng(fileInput.files[0]);
        //console.log(blocks.length);
    }

</script>
</html>